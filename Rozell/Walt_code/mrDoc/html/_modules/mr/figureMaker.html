

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mr.figureMaker &mdash; Walt Woods&#39; Thesis Work 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Walt Woods&#39; Thesis Work 1.0 documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Walt Woods' Thesis Work
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/mr.datasets.html">mr.datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/mr.electrical.html">mr.electrical</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/mr.figureMaker.html">mr.figureMaker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/mr.optimize.html">mr.optimize</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/mr.supervised.html">mr.supervised</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/mr.unsupervised.html">mr.unsupervised</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">Walt Woods' Thesis Work</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>mr.figureMaker</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for mr.figureMaker</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;A figure generator for slicing and displaying data.  Example usage:</span>

<span class="sd">.. code-block:: python</span>

<span class="sd">    import pandas</span>
<span class="sd">    data = pandas.DataFrame()</span>
<span class="sd">    data[&quot;a&quot;] = None</span>
<span class="sd">    data[&quot;b&quot;] = None</span>
<span class="sd">    data.loc[0] = [ 1, 1 ]</span>
<span class="sd">    data.loc[1] = [ 2, 2 ]</span>
<span class="sd">    data.loc[2] = [ 3, 2 ]</span>
<span class="sd">    maker = FigureMaker(data, &quot;images/&quot;, imageExtension = &quot;png&quot;)</span>
<span class="sd">    maker.bind(&quot;a&quot;).setup(label = &quot;First column&quot;)</span>
<span class="sd">    maker.bind(&quot;b&quot;).setup(label = &quot;Second column&quot;, scale = &quot;log&quot;)</span>

<span class="sd">    with maker.new(&quot;a vs b&quot;) as fig:</span>
<span class="sd">        fig.plotValue(&quot;a and b&quot;, &quot;a&quot;, &quot;b&quot;)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.image</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">PIL.Image</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="c1"># Should come from python-slugify!</span>
<span class="kn">from</span> <span class="nn">slugify</span> <span class="kn">import</span> <span class="n">slugify</span>

<span class="n">_missing</span> <span class="o">=</span> <span class="p">{}</span>


<div class="viewcode-block" id="_Figure"><a class="viewcode-back" href="../../_autosummary/mr.figureMaker.html#mr.figureMaker._Figure">[docs]</a><span class="k">class</span> <span class="nc">_Figure</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;Produced by :meth:`FigureMaker.new`.  Most plotting functions can take</span>
<span class="sd">    the following arguments:</span>

<span class="sd">    :kwargs:</span>
<span class="sd">        :sort: By default, data is sorted by the data columns that are being</span>
<span class="sd">                used for the plot.  However, if there is a hidden column (such</span>
<span class="sd">                as time) that should be used for sorting instead, specify it</span>
<span class="sd">                here.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">]</span>
    <span class="n">styles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">]</span>
    <span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maker</span><span class="p">,</span> <span class="n">figureName</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">legendAnchor</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maker</span> <span class="o">=</span> <span class="n">maker</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">tight</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_legendAnchor</span> <span class="o">=</span> <span class="n">legendAnchor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">axes</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span><span class="o">.</span><span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">axes</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span><span class="o">.</span><span class="n">height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lineCount</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_legendHandles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figureName</span> <span class="o">=</span> <span class="n">figureName</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figureList</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_xBinding</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_yBinding</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_yBinding2</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1"># Used only when there are two y axes.  Color of first rendered line</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_yaxis1Color</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_yaxis2</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1"># For multiple renderings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_saved</span> <span class="o">=</span> <span class="bp">False</span>


    <span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>


    <span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tb</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># Draw our legend</span>
            <span class="n">extraArtists</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_legendAnchor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_legendHandles</span><span class="p">:</span>
                <span class="n">legArgs</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s1">&#39;handles&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_legendHandles</span><span class="p">,</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_legendAnchor</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
                    <span class="c1"># Anchor!</span>
                    <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_legendAnchor</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                            <span class="n">bbox_to_anchor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_legendAnchor</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="o">**</span><span class="n">legArgs</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_legendAnchor</span><span class="p">,</span> <span class="o">**</span><span class="n">legArgs</span><span class="p">)</span>
                <span class="n">extraArtists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

            <span class="c1"># Update second y axis colors</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yaxis2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_ylabel</span><span class="p">(),</span>
                        <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yaxis1Color</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
                    <span class="n">t</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_yaxis1Color</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yaxis2</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
                    <span class="n">t</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_yaxis2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figureList</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_saveFigure</span><span class="p">(</span><span class="n">extraArtists</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_figureList</span><span class="o">.</span><span class="n">extraArtists</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extraArtists</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_saveFigure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extraArtists</span><span class="p">):</span>
        <span class="c1"># Finish rendering to file, THEN render to IPython with the title</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">maker</span><span class="o">.</span><span class="n">imageDestFolder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">fname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maker</span><span class="o">.</span><span class="n">getFigurePath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_figureName</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">lexists</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_saved</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot name two figures {} (slugged {})&quot;</span>
                            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_figureName</span><span class="p">,</span> <span class="n">slugName</span><span class="p">))</span>
            <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span>
                    <span class="n">dpi</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">],</span>
                    <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span>
                    <span class="n">bbox_extra_artists</span> <span class="o">=</span> <span class="n">extraArtists</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_saved</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_figureName</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">24</span><span class="p">)</span>

        <span class="c1"># Close to save memory</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">figure</span><span class="p">)</span>


<div class="viewcode-block" id="_Figure.getDataLimits"><a class="viewcode-back" href="../../_autosummary/mr.figureMaker.html#mr.figureMaker._Figure.getDataLimits">[docs]</a>    <span class="k">def</span> <span class="nf">getDataLimits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the currently plotted data limits.  Object has xmin, xmax,</span>
<span class="sd">        ymin, and ymax attributes.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">dataLim</span></div>


<div class="viewcode-block" id="_Figure.plotImage"><a class="viewcode-back" href="../../_autosummary/mr.figureMaker.html#mr.figureMaker._Figure.plotImage">[docs]</a>    <span class="k">def</span> <span class="nf">plotImage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot a column of image _paths_ as staggered images in a plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">innerPlot</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
            <span class="n">xMin</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="n">xMax</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="k">def</span> <span class="nf">mapX</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                <span class="sd">&quot;&quot;&quot;Returns the imAxes.x coordinate for a data (axes.) x coordinate&quot;&quot;&quot;</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">xMin</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">xMax</span> <span class="o">-</span> <span class="n">xMin</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">unmapX</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                <span class="sd">&quot;&quot;&quot;Returns the axes.x coordinate for an imAxes.x coordinate&quot;&quot;&quot;</span>
                <span class="k">return</span> <span class="n">xMin</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">xMax</span> <span class="o">-</span> <span class="n">xMin</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">calcBounds</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">width</span><span class="p">):</span>
                <span class="sd">&quot;&quot;&quot;Given an imAxes x and width, return the imAxes left and right.&quot;&quot;&quot;</span>
                <span class="n">partLeft</span> <span class="o">=</span> <span class="n">x</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">width</span> <span class="o">*</span> <span class="n">partLeft</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">partLeft</span><span class="p">))</span>

            <span class="c1"># Use the twin axis for our images, and the primary x axis for ticks</span>
            <span class="c1"># (and possibly log scaling)</span>
            <span class="n">imAxes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>

            <span class="c1"># Original axes must be set AFTER twinning (true for y, anyway)</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">)</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ymargin</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([])</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span> <span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span> <span class="p">],</span> <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span> <span class="p">],</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_legendAnchor</span> <span class="o">=</span> <span class="bp">None</span>

            <span class="c1"># Now set up our twin axes</span>
            <span class="n">imAxes</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;linear&quot;</span><span class="p">)</span>
            <span class="n">imAxes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="n">imAxes</span><span class="o">.</span><span class="n">set_xmargin</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="n">imAxes</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([])</span>

            <span class="c1"># Gutter margin for arrows</span>
            <span class="n">imMargin</span> <span class="o">=</span> <span class="mf">0.01</span>
            <span class="n">imLowestY</span> <span class="o">=</span> <span class="n">imMargin</span>

            <span class="k">if</span> <span class="n">axes</span><span class="o">.</span><span class="n">get_xscale</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">mapLogX</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">xMin</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">xMax</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">xMin</span><span class="p">))</span>
                <span class="n">mapX</span> <span class="o">=</span> <span class="n">mapLogX</span>
                <span class="k">def</span> <span class="nf">unmapLogX</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">xMax</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">xMin</span><span class="p">))</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">xMin</span><span class="p">))</span>
                <span class="n">unmapX</span> <span class="o">=</span> <span class="n">unmapLogX</span>

            <span class="c1"># List of [ imData, imAxesAspect, dataX, imAxesY, imAxesWidth ]</span>
            <span class="n">images</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># imAxes are bound on X between [0, 1] and Y between [0, 1].  So,</span>
            <span class="c1"># aspect is same as figure width and height.</span>
            <span class="n">imAxesAspect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span>
            <span class="k">for</span> <span class="n">coord</span><span class="p">,</span> <span class="n">imPath</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">img</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
                <span class="c1"># Load and ensure RGBA, flip to correspond to matplotlib&#39;s coordinates</span>
                <span class="n">image</span> <span class="o">=</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">imPath</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGBA&quot;</span><span class="p">)</span>
                <span class="c1"># nativeAspect is the aspect ratio of the image</span>
                <span class="n">nativeAspect</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">image</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">axesAspect</span> <span class="o">=</span> <span class="n">nativeAspect</span> <span class="o">/</span> <span class="n">imAxesAspect</span>
                <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">([</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">image</span><span class="p">),</span> <span class="n">axesAspect</span><span class="p">,</span> <span class="n">coord</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">imMargin</span><span class="p">)</span> <span class="o">/</span> <span class="n">axesAspect</span><span class="p">)</span> <span class="p">])</span>

            <span class="c1"># Now figure out positions....  this is slow, but we want them all to be the</span>
            <span class="c1"># same scale, so...just stack them ideally.</span>
            <span class="n">baseScale</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">ok</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">)):</span>
                    <span class="c1"># For each image, detect a &quot;safe y&quot; based on images before it</span>
                    <span class="n">safeY</span> <span class="o">=</span> <span class="mf">1.0</span>
                    <span class="n">myBoundsX</span> <span class="o">=</span> <span class="n">calcBounds</span><span class="p">(</span><span class="n">mapX</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]),</span> <span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="n">baseScale</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
                        <span class="n">myBoundsY</span> <span class="o">=</span> <span class="p">(</span><span class="n">safeY</span> <span class="o">-</span> <span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="n">baseScale</span> <span class="o">*</span> <span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">safeY</span><span class="p">)</span>
                        <span class="n">boundsX</span> <span class="o">=</span> <span class="n">calcBounds</span><span class="p">(</span><span class="n">mapX</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">2</span><span class="p">]),</span> <span class="n">images</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="n">baseScale</span><span class="p">)</span>
                        <span class="n">boundsY</span> <span class="o">=</span> <span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">images</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="n">baseScale</span> <span class="o">*</span> <span class="n">images</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">images</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>

                        <span class="k">if</span> <span class="n">myBoundsX</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">boundsX</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">myBoundsX</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">boundsX</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                            <span class="k">if</span> <span class="n">myBoundsY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">boundsY</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">myBoundsY</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">boundsY</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                                <span class="c1"># Overlap!  We can only move down, since we start at the top</span>
                                <span class="n">safeY</span> <span class="o">=</span> <span class="n">boundsY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">imMargin</span>
                                <span class="k">if</span> <span class="n">safeY</span> <span class="o">-</span> <span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="n">baseScale</span> <span class="o">*</span> <span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">imLowestY</span><span class="p">:</span>
                                    <span class="n">ok</span> <span class="o">=</span> <span class="bp">False</span>
                                    <span class="k">break</span>

                    <span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">safeY</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="n">ok</span><span class="p">:</span>
                        <span class="k">break</span>

                <span class="k">if</span> <span class="n">ok</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">baseScale</span> <span class="o">*=</span> <span class="mf">0.9</span>

            <span class="c1"># Now that we&#39;ve calculated the display, render everything</span>
            <span class="k">for</span> <span class="n">imData</span><span class="p">,</span> <span class="n">axesAspect</span><span class="p">,</span> <span class="n">dataX</span><span class="p">,</span> <span class="n">imAxesY</span><span class="p">,</span> <span class="n">imAxesWidth</span> <span class="ow">in</span> <span class="n">images</span><span class="p">:</span>
                <span class="n">imX</span> <span class="o">=</span> <span class="n">mapX</span><span class="p">(</span><span class="n">dataX</span><span class="p">)</span>
                <span class="c1"># Apply our new scaling</span>
                <span class="n">imAxesWidth</span> <span class="o">*=</span> <span class="n">baseScale</span>
                <span class="n">imYBottom</span> <span class="o">=</span> <span class="n">imAxesY</span> <span class="o">-</span> <span class="n">axesAspect</span> <span class="o">*</span> <span class="n">imAxesWidth</span>
                <span class="n">bounds</span> <span class="o">=</span> <span class="n">calcBounds</span><span class="p">(</span><span class="n">imX</span><span class="p">,</span> <span class="n">imAxesWidth</span><span class="p">)</span>
                <span class="n">imAxes</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imData</span><span class="p">,</span> <span class="n">interpolation</span> <span class="o">=</span> <span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">aspect</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                        <span class="n">extent</span> <span class="o">=</span> <span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">imYBottom</span><span class="p">,</span> <span class="n">imAxesY</span><span class="p">))</span>
                <span class="n">arrowX</span> <span class="o">=</span> <span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.5</span>
                <span class="n">imAxes</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">imX</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">xycoords</span> <span class="o">=</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span>
                        <span class="n">xytext</span> <span class="o">=</span> <span class="p">(</span><span class="n">arrowX</span><span class="p">,</span> <span class="n">imYBottom</span><span class="p">),</span> <span class="n">textcoords</span> <span class="o">=</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span>
                        <span class="n">arrowprops</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span> <span class="o">=</span> <span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">connectionstyle</span> <span class="o">=</span> <span class="s2">&quot;arc3&quot;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_callPlot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">innerPlot</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">plotBar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">xInd</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">plotBar_inner</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
            <span class="n">opts</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">0.35</span> <span class="p">}</span>
            <span class="k">if</span> <span class="n">y2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">opts</span><span class="p">[</span><span class="s1">&#39;yerr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">y2</span><span class="p">]</span>
            <span class="n">opts</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
            <span class="n">opts</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;linestyle&#39;</span><span class="p">)</span>
            <span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">]))</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">dx</span> <span class="o">+</span> <span class="n">xInd</span> <span class="o">*</span> <span class="n">opts</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
            <span class="n">locs</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">dx</span> <span class="o">+</span> <span class="n">opts</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">xInd</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="n">styl</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="bp">None</span> <span class="p">}</span>
        <span class="n">styl</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callPlot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">plotBar_inner</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">styl</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<div class="viewcode-block" id="_Figure.plotCustom"><a class="viewcode-back" href="../../_autosummary/mr.figureMaker.html#mr.figureMaker._Figure.plotCustom">[docs]</a>    <span class="k">def</span> <span class="nf">plotCustom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cb</span><span class="p">,</span> <span class="n">xAxis</span><span class="p">,</span> <span class="n">yAxis</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calls ``cb`` with the data filtered as specified by ``kwargs`` and</span>
<span class="sd">        the axes set up for ``xAxis`` and ``yAxis``.&quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">plotCustomInner</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
            <span class="n">cb</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callPlot</span><span class="p">(</span><span class="n">xAxis</span><span class="p">,</span> <span class="n">yAxis</span><span class="p">,</span> <span class="n">plotCustomInner</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">plotCustomValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">xTuple</span><span class="p">,</span> <span class="n">yTuple</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">plotNoMarkers</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
            <span class="n">options</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;markevery&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xTuple</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">yTuple</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">options</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_callPlot</span><span class="p">(</span><span class="n">xTuple</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">yTuple</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">plotNoMarkers</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">plotError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callPlot</span><span class="p">(</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
                <span class="k">lambda</span> <span class="n">axes</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="n">axes</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">],</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">y2</span><span class="p">],</span> <span class="n">capsize</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">),</span>
                <span class="n">label</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">plotFill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callPlot</span><span class="p">(</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
                <span class="k">lambda</span> <span class="n">axes</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="n">axes</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">],</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">y2</span><span class="p">],</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">],</span>
                        <span class="n">alpha</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]),</span>
                <span class="bp">None</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<div class="viewcode-block" id="_Figure.plotHeat"><a class="viewcode-back" href="../../_autosummary/mr.figureMaker.html#mr.figureMaker._Figure.plotHeat">[docs]</a>    <span class="k">def</span> <span class="nf">plotHeat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Uses pcolor.  Extra style options:</span>

<span class="sd">        smooth - If True, smooth the heatmap</span>

<span class="sd">        useDataLimits - If True, ignore bounds on z axis, using data limits</span>
<span class="sd">                after filtering instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">style</span> <span class="o">=</span> <span class="n">style</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">smooth</span> <span class="o">=</span> <span class="n">style</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;smooth&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
        <span class="n">useDataLimits</span> <span class="o">=</span> <span class="n">style</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;useDataLimits&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getFiltered</span><span class="p">([],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># The bindings for the different axes</span>
        <span class="n">xBinding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maker</span><span class="o">.</span><span class="n">getBinding</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">yBinding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maker</span><span class="o">.</span><span class="n">getBinding</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">zBinding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maker</span><span class="o">.</span><span class="n">getBinding</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="n">nd</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">nd</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

        <span class="c1"># Normalize according to zlimits</span>
        <span class="n">limits</span> <span class="o">=</span> <span class="n">zBinding</span><span class="o">.</span><span class="n">limits</span><span class="p">[:]</span>
        <span class="k">if</span> <span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">useDataLimits</span><span class="p">:</span>
            <span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">useDataLimits</span><span class="p">:</span>
            <span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">zBinding</span><span class="o">.</span><span class="n">scale</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span><span class="p">:</span>
            <span class="n">normalizer</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">zBinding</span><span class="o">.</span><span class="n">scale</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
            <span class="n">normalizer</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">zBinding</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>

        <span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">norm</span> <span class="o">=</span> <span class="n">normalizer</span><span class="p">,</span>
                <span class="n">shading</span> <span class="o">=</span> <span class="s1">&#39;gouraud&#39;</span> <span class="k">if</span> <span class="n">smooth</span> <span class="k">else</span> <span class="s1">&#39;flat&#39;</span><span class="p">,</span>
                <span class="c1"># Fix PDF output</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rasterized</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">defaults</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
        <span class="n">plotted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">nd</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">defaults</span><span class="p">)</span>
        <span class="n">plotted</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s1">&#39;face&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">yBinding</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">yBinding</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xBinding</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">xBinding</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">plotted</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">plotStem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">doStem</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">])</span>
            <span class="c1">#r = (marker, stem, base)</span>
            <span class="n">markOpts</span> <span class="o">=</span> <span class="p">{</span> <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;mark&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span> <span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span> <span class="p">]</span> <span class="p">}</span>
            <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">markOpts</span><span class="p">)</span>
            <span class="n">nopts</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">nopts</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;marker&#39;</span><span class="p">)</span>
            <span class="p">[</span> <span class="n">c</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">nopts</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">]</span>
            <span class="n">nopts</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">nopts</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;markevery&#39;</span><span class="p">)</span>
            <span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">nopts</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callPlot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">doStem</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">plotValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callPlot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
                <span class="c1"># Note that this lambda returns the first object since we only plot</span>
                <span class="c1"># one line.</span>
                <span class="k">lambda</span> <span class="n">axes</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">],</span>
                        <span class="o">**</span><span class="n">options</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">label</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<div class="viewcode-block" id="_Figure.render"><a class="viewcode-back" href="../../_autosummary/mr.figureMaker.html#mr.figureMaker._Figure.render">[docs]</a>    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;For usage without a &#39;with&#39; block.  Can be called multiple times&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__exit__</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_getFiltered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sortFields</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maker</span><span class="o">.</span><span class="n">data</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_lt&quot;</span><span class="p">):</span>
                <span class="n">k</span> <span class="o">=</span> <span class="n">k</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">v</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">k</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_lte&quot;</span><span class="p">):</span>
                <span class="n">k</span> <span class="o">=</span> <span class="n">k</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">v</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">k</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_gt&quot;</span><span class="p">):</span>
                <span class="n">k</span> <span class="o">=</span> <span class="n">k</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">v</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">k</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_gte&quot;</span><span class="p">):</span>
                <span class="n">k</span> <span class="o">=</span> <span class="n">k</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">v</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">v</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">v</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">sortFields</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">maker</span><span class="o">.</span><span class="n">_sort</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">sortFields</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>


    <span class="k">def</span> <span class="nf">_callPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xDataName</span><span class="p">,</span> <span class="n">yDataName</span><span class="p">,</span> <span class="n">plotMethod</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span>
            <span class="n">sort</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">sort</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="p">[</span> <span class="n">xDataName</span><span class="p">,</span> <span class="n">yDataName</span> <span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getFiltered</span><span class="p">(</span><span class="n">sort</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">plotOptions</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">label</span><span class="p">,</span>
                <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_lineCount</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">)],</span>
                <span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">styles</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_lineCount</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">styles</span><span class="p">)],</span>
                <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">markers</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_lineCount</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">markers</span><span class="p">)],</span>
                <span class="s1">&#39;markeredgecolor&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                <span class="s1">&#39;markersize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="s1">&#39;marker&#39;</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
            <span class="c1"># We need to overwrite this now so that we&#39;ll know if we want to</span>
            <span class="c1"># skip marker calculations (done for marker is None)</span>
            <span class="n">plotOptions</span><span class="p">[</span><span class="s1">&#39;marker&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">style</span><span class="p">[</span><span class="s1">&#39;marker&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">plotOptions</span><span class="p">[</span><span class="s1">&#39;marker&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;*&#39;</span><span class="p">:</span>
            <span class="c1"># stars are small</span>
            <span class="n">plotOptions</span><span class="p">[</span><span class="s1">&#39;markersize&#39;</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">1.5</span>

        <span class="c1"># The bindings for the different axes</span>
        <span class="n">xBinding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maker</span><span class="o">.</span><span class="n">getBinding</span><span class="p">(</span><span class="n">xDataName</span><span class="p">)</span>
        <span class="n">yBinding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maker</span><span class="o">.</span><span class="n">getBinding</span><span class="p">(</span><span class="n">yDataName</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">plotOptions</span><span class="p">[</span><span class="s1">&#39;marker&#39;</span><span class="p">]:</span>
            <span class="c1"># Calculate markers according to numTicks</span>
            <span class="n">numTicks</span> <span class="o">=</span> <span class="mf">5.0</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lineCount</span>
            <span class="k">if</span> <span class="n">numTicks</span> <span class="o">&lt;</span> <span class="mf">3.0</span><span class="p">:</span>
                <span class="n">numTicks</span> <span class="o">=</span> <span class="mf">9.25</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lineCount</span>
            <span class="k">if</span> <span class="n">numTicks</span> <span class="o">&lt;</span> <span class="mf">3.0</span><span class="p">:</span>
                <span class="n">numTicks</span> <span class="o">=</span> <span class="mf">13.35</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lineCount</span>
            <span class="n">markers</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">xdata</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">xDataName</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="k">if</span> <span class="n">xBinding</span><span class="o">.</span><span class="n">scale</span> <span class="o">==</span> <span class="s1">&#39;log&#39;</span><span class="p">:</span>
                <span class="n">xdata</span> <span class="o">=</span> <span class="p">[</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xdata</span> <span class="p">]</span>
            <span class="c1"># If we want 4 ticks, plus an extra half space at each end, then we</span>
            <span class="c1"># need exactly as many spaces as we have ticks.</span>
            <span class="n">markDist</span> <span class="o">=</span> <span class="p">(</span><span class="n">xdata</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">numTicks</span>
            <span class="c1"># Since we have half ticks, rather than using a half offset, we&#39;ll</span>
            <span class="c1"># use a quarter for those.</span>
            <span class="n">scalar</span> <span class="o">=</span> <span class="mf">0.5</span>
            <span class="n">scalar</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">numTicks</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">numTicks</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">markNext</span> <span class="o">=</span> <span class="n">xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">markDist</span> <span class="o">*</span> <span class="n">scalar</span>
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xdata</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">xdata</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">markNext</span><span class="p">:</span>
                    <span class="n">markers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
                    <span class="n">markNext</span> <span class="o">+=</span> <span class="n">markDist</span>
            <span class="n">plotOptions</span><span class="p">[</span><span class="s1">&#39;markevery&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">markers</span>

            <span class="c1"># End of plot options, update with style</span>
            <span class="n">plotOptions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Update with style BEFORE removing marker stuff</span>
            <span class="n">plotOptions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>

            <span class="c1"># Take out all marker options</span>
            <span class="n">plotOptions</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;marker&#39;</span><span class="p">)</span>
            <span class="n">plotOptions</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;markeredgecolor&#39;</span><span class="p">)</span>
            <span class="n">plotOptions</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;markersize&#39;</span><span class="p">)</span>

        <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>

        <span class="c1"># Enforce X and Y axis general properties BEFORE render, since e.g.</span>
        <span class="c1"># image rendering needs to know if something is a log distribution.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xBinding</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_xBinding</span> <span class="o">=</span> <span class="n">xBinding</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xBinding</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">xBinding</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xBinding</span> <span class="o">!=</span> <span class="n">xBinding</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Using multiple x axes in one plot?  Unwise!&quot;</span><span class="p">)</span>

        <span class="n">canUseSecondY</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">useSecondY</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="s1">&#39;axis&#39;</span> <span class="ow">in</span> <span class="n">plotOptions</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plotOptions</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;axis&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">canUseSecondY</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">elif</span> <span class="n">ax</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">useSecondY</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Got &#39;axis&#39; from style: {}.  Must be 0 or 1.&quot;</span>
                        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ax</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yBinding</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_yBinding</span> <span class="o">=</span> <span class="n">yBinding</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">yBinding</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">yBinding</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_yaxis1Color</span> <span class="o">=</span> <span class="n">plotOptions</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">canUseSecondY</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_yBinding</span> <span class="o">!=</span> <span class="n">yBinding</span> <span class="ow">or</span> <span class="n">useSecondY</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yBinding2</span> <span class="o">==</span> <span class="n">yBinding</span><span class="p">:</span>
                <span class="c1"># Ok, plot to second</span>
                <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yaxis2</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yBinding2</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c1"># Create a second axis and plot to that</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_yBinding2</span> <span class="o">=</span> <span class="n">yBinding</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_yaxis2</span> <span class="o">=</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
                <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">yBinding</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">plotOptions</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>
                <span class="n">axes</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">yBinding</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Using multiple y axes in one plot?  Unwise!&quot;</span><span class="p">)</span>

        <span class="n">plotted</span> <span class="o">=</span> <span class="n">plotMethod</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">plotOptions</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">plotted</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_legendHandles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plotted</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lineCount</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># --- Update xlimits based on data</span>
        <span class="n">dataLimits</span> <span class="o">=</span> <span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">dataLim</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="n">axes</span><span class="o">.</span><span class="n">dataLim</span><span class="o">.</span><span class="n">xmax</span><span class="p">)</span>
        <span class="c1"># Fully specified is OK, but a single None doesn&#39;t really work with matplotlib</span>
        <span class="n">limits</span> <span class="o">=</span> <span class="n">xBinding</span><span class="o">.</span><span class="n">limits</span>
        <span class="k">if</span> <span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">auto</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
            <span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span> <span class="o">=</span> <span class="n">dataLimits</span>
            <span class="k">if</span> <span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">xMin</span> <span class="o">=</span> <span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">xMax</span> <span class="o">=</span> <span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">limits</span><span class="p">)</span>

        <span class="c1"># --- Update ylimits and margin based on data</span>
        <span class="n">dataLimits</span> <span class="o">=</span> <span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">dataLim</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="n">axes</span><span class="o">.</span><span class="n">dataLim</span><span class="o">.</span><span class="n">ymax</span><span class="p">)</span>
        <span class="c1"># Fully specified is OK, but a single None doesn&#39;t really work with matplotlib</span>
        <span class="n">limits</span> <span class="o">=</span> <span class="n">yBinding</span><span class="o">.</span><span class="n">limits</span>
        <span class="k">if</span> <span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">auto</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
            <span class="n">yMin</span><span class="p">,</span> <span class="n">yMax</span> <span class="o">=</span> <span class="n">dataLimits</span>
            <span class="k">if</span> <span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">yMin</span> <span class="o">=</span> <span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">yMax</span> <span class="o">=</span> <span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">yMin</span><span class="p">,</span> <span class="n">yMax</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">limits</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">plotted</span></div>


<span class="k">class</span> <span class="nc">_FigureList</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_FigureList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">fig</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extraArtists</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tb</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">e</span><span class="o">.</span><span class="n">__exit__</span><span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tb</span><span class="p">)</span>

        <span class="c1"># Fine tuning, remove duplicate x ticks and put the plots next to</span>
        <span class="c1"># each other</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">setp</span><span class="p">([</span> <span class="n">a</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">],</span>
                <span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>

        <span class="c1"># Do this only once</span>
        <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_saveFigure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extraArtists</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_FigureList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="n">val</span><span class="o">.</span><span class="n">_figureList</span> <span class="o">=</span> <span class="bp">self</span>


    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;For usage without a &#39;with&#39; block.  Can be called multiple times&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__exit__</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>



<span class="k">class</span> <span class="nc">FigureMaker</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sort</span>


    <span class="nd">@sort.setter</span>
    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newVal</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sort</span> <span class="o">=</span> <span class="n">newVal</span>


    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">imageDestFolder</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">imageExtension</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span>
            <span class="n">imagePrefix</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">defaultHeightAspect</span> <span class="o">=</span> <span class="mf">0.618</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a rendering platform based on some data.  Note that sort</span>
<span class="sd">        applies to individual plots!  E.g., you cannot make a proper I-V curve</span>
<span class="sd">        or other plot that has multiple Y-value for a single X-value if sort is</span>
<span class="sd">        set to True (default).&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imageDestFolder</span> <span class="o">=</span> <span class="n">imageDestFolder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imagePrefix</span> <span class="o">=</span> <span class="n">imagePrefix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imageExtension</span> <span class="o">=</span> <span class="n">imageExtension</span>
        <span class="k">if</span> <span class="n">imageExtension</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span> <span class="s1">&#39;eps&#39;</span><span class="p">,</span> <span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;png&#39;</span> <span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unrecognized image format: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">imageExtension</span><span class="p">))</span>

        <span class="c1"># Clear out all old png files</span>
        <span class="k">if</span> <span class="n">imageDestFolder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">imageDestFolder</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="c1"># Already exists</span>
                <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">errno</span> <span class="o">!=</span> <span class="mi">17</span><span class="p">:</span>
                    <span class="k">raise</span>
            <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">imageDestFolder</span><span class="p">):</span>
                <span class="c1"># Only remove images of our type and prefix</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">r&quot;^.*\.(eps|pdf|png|mp4)$&quot;</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="n">imagePrefix</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">fn</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">imagePrefix</span><span class="p">):</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">imageDestFolder</span><span class="p">,</span> <span class="n">fn</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;heightAspect&#39;</span><span class="p">:</span> <span class="n">defaultHeightAspect</span> <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span> <span class="o">=</span> <span class="n">scale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_marginDefault</span> <span class="o">=</span> <span class="mf">0.00</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unnamedCount</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sort</span> <span class="o">=</span> <span class="n">sort</span>

        <span class="c1"># Sets _bindings and _nameToBinding</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


    <span class="k">class</span> <span class="nc">Binding</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Represents a group of data sharing the same axis.&quot;&quot;&quot;</span>
        <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;_maker&#39;</span><span class="p">,</span> <span class="s1">&#39;_names&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;limits&#39;</span><span class="p">,</span> <span class="s1">&#39;scale&#39;</span> <span class="p">]</span>
        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maker</span><span class="p">,</span> <span class="n">dataNames</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_maker</span> <span class="o">=</span> <span class="n">maker</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="n">dataNames</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataNames</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">dataNames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dataNames</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">limits</span> <span class="o">=</span> <span class="p">[</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span> <span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span>


        <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;FigureMaker.Binding({})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>


        <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Same effect as calling maker.bind() with the union of the</span>
<span class="sd">            bindings specified by add&#39;s arguments and the original bind call.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">nkwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">nkwargs</span><span class="p">[</span><span class="s1">&#39;addTo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maker</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">nkwargs</span><span class="p">)</span>


        <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">limits</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;limits&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unrecognized kwargs: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span>


    <span class="k">def</span> <span class="nf">bind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataNames</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">startswith</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">endswith</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
            <span class="n">addTo</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Accepts either a single string or a collection of strings.  Binds all</span>
<span class="sd">        given names together on the same scale, allowing them to share a label</span>
<span class="sd">        and other settings.</span>

<span class="sd">        Note: You can also specify bind(startswith = &quot;hey&quot;) to bind similarly</span>
<span class="sd">        prefixed names.  Suffixes available via endswith.</span>

<span class="sd">        addTo - If specified, add detected columns to this binding rather than</span>
<span class="sd">                creating a new binding.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">colset</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataNames</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">colset</span> <span class="o">=</span> <span class="p">[</span> <span class="n">dataNames</span> <span class="p">]</span>
        <span class="k">elif</span> <span class="n">dataNames</span><span class="p">:</span>
            <span class="n">colset</span> <span class="o">=</span> <span class="n">dataNames</span>
        <span class="k">elif</span> <span class="n">startswith</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">colset</span> <span class="o">=</span> <span class="p">[</span> <span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">startswith</span><span class="p">)</span> <span class="p">]</span>
            <span class="k">if</span> <span class="n">endswith</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">colset</span> <span class="o">=</span> <span class="p">[</span> <span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">colset</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">endswith</span><span class="p">)</span> <span class="p">]</span>
        <span class="k">elif</span> <span class="n">endswith</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">colset</span> <span class="o">=</span> <span class="p">[</span> <span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">endswith</span><span class="p">)</span> <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unrecognized bind arguments&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">addTo</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">binding</span> <span class="o">=</span> <span class="n">FigureMaker</span><span class="o">.</span><span class="n">Binding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">colset</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bindings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binding</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">colset</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nameToBinding</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Column {} is already bound!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_nameToBinding</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">binding</span>

            <span class="k">return</span> <span class="n">binding</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">colset</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nameToBinding</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nameToBinding</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="n">addTo</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Column {} is already bound to a &quot;</span>
                                <span class="s2">&quot;different binding!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
                    <span class="c1"># OK if it&#39;s in addTo</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_nameToBinding</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">addTo</span>
                    <span class="n">addTo</span><span class="o">.</span><span class="n">_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">addTo</span>


    <span class="k">def</span> <span class="nf">getBinding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataName</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the Binding for a given dataName&quot;&quot;&quot;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nameToBinding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dataName</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">dataName</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span>


    <span class="k">def</span> <span class="nf">getFigurePath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figureName</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Given a figureName, return the path to that figure.  Optionally,</span>
<span class="sd">        the extension may be overridden.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">slugName</span> <span class="o">=</span> <span class="n">slugify</span><span class="p">(</span><span class="n">figureName</span><span class="p">)</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">imagePrefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">imagePrefix</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">extension</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">imageExtension</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">extension</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imageDestFolder</span><span class="p">,</span>
                <span class="n">prefix</span> <span class="o">+</span> <span class="n">slugName</span> <span class="o">+</span> <span class="n">ext</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fname</span>


    <span class="k">def</span> <span class="nf">new</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figureName</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">heightAspect</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="n">legendLoc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">legendAnchor</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">nplotsHigh</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;legendLoc - The loc argument for a legend in pyplot.  1 is upper right,</span>
<span class="sd">        2 is lower right, etc.  Defaults to 0 - best.  Can also be strings &#39;upper</span>
<span class="sd">        right&#39;, etc.  Pass legendLoc = None to disable the legend.</span>

<span class="sd">        legendAnchor - Overrides legendLoc.  3-tuple of (corner, x, y).</span>
<span class="sd">                E.g. (&#39;upper right&#39;, 0, 0) will position the legend&#39;s upper right</span>
<span class="sd">                corner at 0, 0</span>

<span class="sd">        nplotsHigh - Number of plots on the vertical scale.</span>

<span class="sd">        Returns - if nplotsHigh is not specified, returns a _Figure object for</span>
<span class="sd">        plotting.  If it is specified, returns a list of _Figure objects in</span>
<span class="sd">        left-&gt;right and top-&gt;bottom (english reading order).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">baseSize</span> <span class="o">=</span> <span class="mf">6.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span> <span class="o">*</span> <span class="n">scale</span>
        <span class="k">if</span> <span class="n">figureName</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_unnamedCount</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">figureName</span> <span class="o">=</span> <span class="s2">&quot;Unnamed {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_unnamedCount</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">heightAspect</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">heightAspect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defaults</span><span class="p">[</span><span class="s1">&#39;heightAspect&#39;</span><span class="p">]</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nplotsHigh</span><span class="p">,</span>
                <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">baseSize</span><span class="p">,</span> <span class="n">baseSize</span> <span class="o">*</span> <span class="n">heightAspect</span><span class="p">),</span> <span class="n">squeeze</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span>
                <span class="n">sharex</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">sharey</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>

        <span class="c1"># No space between axes!</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">legendAnchor</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">legendAnchor</span> <span class="o">=</span> <span class="n">legendLoc</span>
        <span class="n">figs</span> <span class="o">=</span> <span class="n">_FigureList</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">r</span><span class="p">:</span>
                <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_Figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figureName</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">legendAnchor</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">nplotsHigh</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">figs</span>
        <span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_figureList</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>


    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newData</span><span class="p">,</span> <span class="n">imagePrefix</span> <span class="o">=</span> <span class="n">_missing</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Resets the FigureMaker to operate on a new set of data.  This has the</span>
<span class="sd">        advantage of not deleting files, and keeping format / other options.</span>
<span class="sd">        However, bindings are erased.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">newData</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bindings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nameToBinding</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">imagePrefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_missing</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imagePrefix</span> <span class="o">=</span> <span class="n">imagePrefix</span>



<span class="c1"># Set all plot default parameters</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
        <span class="s1">&#39;figure.dpi&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
        <span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
        <span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
        <span class="s1">&#39;legend.fontsize&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
        <span class="s1">&#39;text.latex.unicode&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
        <span class="s1">&#39;text.usetex&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
<span class="p">})</span>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Walt Woods.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>